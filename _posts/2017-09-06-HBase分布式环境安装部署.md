---
layout: post
title:  "HBase分布式环境安装部署"
date:   2017-09-06 15:09:08 +0800
categories: Hadoop
tags: HBase
author: jeff
mathjax: true
---

* content
{:toc}


# 实验说明
* 我们在之前成功搭建Hadoop集群上继续操作，有了这个基础再安装HBase应该就比较简单了

* 节点角色
    h1，h2：Master    
    h3，h4，h5：RegionServer
    
* 实验如未说明则在h1上使用hadoop用户操作
    
# HBase集群安装
* 1 下载HBase并解压安装    
    cd /home/hadoop/app/
    wget http://apache.ip-guide.com/hbase/1.2.6/hbase-1.2.6-bin.tar.gz    
    tar zxf hbase-1.2.6-bin.tar.gz    
    mv hbase-1.2.6 hbase
    
* 2 切换到root用户编辑/etc/profile，配置HBase环境变量    
    
```xml
JAVA_HOME=/home/hadoop/app/jdk
HADOOP_HOME=/home/hadoop/app/hadoop
ZOOKEEPER_HOME=/home/hadoop/app/zookeeper
HBASE_HOME=/home/hadoop/app/hbase
CLASSPATH=.:$JAVA_HOME/lib/dt/jar:$JAVA_HOME/lib/tools.jar
PATH=$JAVA_HOME/bin:$HADOOP_HOME/bin:$ZOOKEEPER_HOME/bin:$HBASE_HOME/bin:$PATH
export JAVA_HOME CLASSPATH PATH HADOOP_HOME ZOOKEEPER_HOME HBASE_HOME
```

* 3 读取配置使其生效，并将配置文件传到其他4个节点    
    . /etc/profile
    
* 4 修改HBase配置regionservers文件    
    cd /home/hadoop/app/hbase/conf/    
    vim regionservers    
    ![](http://ov7z79pcc.bkt.clouddn.com/15046839563708.jpg)

* 5 配置HBase master的备份节点    
    vim backup-masters    
    ![](http://ov7z79pcc.bkt.clouddn.com/15046840466772.jpg)

* 6 配置hbase-site.xml    
    
```xml
<configuration>
	<property>
        <name>hbase.zookeeper.quorum</name>
        <value>h1,h2,h3,h4,h5</value>
        <!-- 指定ZooKeeper集群位置 -->
    </property>
    <property>
            <name>hbase.zookeeper.property.dataDir</name>
            <value>/home/hadoop/data/zookeeper</value>
            <!-- Zookeeper写数据目录（与ZooKeeper集群上配置相一致）-->
    </property>
    <property>
            <name>hbase.zookeeper.property.clientPort</name>
            <value>2181</value>
            <!-- Zookeeper的端口号 -->
    </property>
	<property>
            <name>hbase.rootdir</name>
            <value>hdfs://cluster1/hbase</value>
            <!-- RegionServers 共享目录 -->
    </property>
    <property>
            <name>hbase.cluster.distributed</name>
            <value>true</value>
            <!-- 开启分布式模式 -->
    </property>
    <property>
            <name>hbase.master</name>
            <value>hdfs://h1:60000</value>
            <!-- 指定Hbase的master的位置 -->
    </property>
</configuration>
```    
**备注：配置这个hbase.rootdir属性的时候，需要将hdfs的core-site.xml和hdfs-site.xml两个配置文件copy到hbase的conf或者lib目录下，否则regionserver不能识别cluster逻辑名称。**

* 7 配置hbase-env.sh，增加如下配置
    vim hbase-env.sh    
    
```xml
# 配置jdk安装路径
export JAVA_HOME=/home/hadoop/app/jdk
# 使用独立的Zookeeper集群
export HBASE_MANAGES_ZK=false
```

* 8 Hbase安装包远程同步到其它节点    
    scp -r /home/hadoop/app/hbase h2:/home/hadoop/app/    
    scp -r /home/hadoop/app/hbase h3:/home/hadoop/app/    
    scp -r /home/hadoop/app/hbase h4:/home/hadoop/app/    
    scp -r /home/hadoop/app/hbase h5:/home/hadoop/app/    
    
* 9 启动Hbase集群    
    * 启动Zookeeper    
        zkServer.sh start
        
    * 启动HDFS    
        /home/hadoop/app/hadoop/sbin/start-dfs.sh
        
    * 启动Hbase    
        start-hbase.sh

